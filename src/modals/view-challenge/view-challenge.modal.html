<ion-header>
  <ion-toolbar>
    <ion-title>
      {{challenge.challenge_name}} Progress
    </ion-title>
    <ion-buttons start>
      <button ion-button (click)="dismiss()">
        <span ion-text color="primary" showWhen="ios">Cancel</span>
        <ion-icon name="md-close" showWhen="android,windows"></ion-icon>
      </button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="outer-content">

  <ion-card>
    <img src="{{challenge.image_url}}"/>
    <ion-item>
      <ion-icon item-left name="trophy"></ion-icon>
      <h2>{{challenge.challenge_name}}</h2>
      <p style="white-space: normal">{{challenge.description}}</p>
    </ion-item>
    <ion-item>
      <ion-icon item-left name="flash"></ion-icon>
      <h2>{{challenge.xp}} XP</h2>
    </ion-item>
    <ion-item>
      <span item-left>{{challenge.completion}} {{challenge.type}}</span>
      <button ion-button icon-left clear item-right
              *ngIf="!challenge.active" color="danger">
        <ion-icon name="clock"></ion-icon>
        <span>Pending</span>
      </button>
    </ion-item>
  </ion-card>

  <ion-list>
    <ion-list-header>
      Participants
    </ion-list-header>

    <ion-spinner name="bubbles" *ngIf="loading"></ion-spinner>

    <ion-card *ngFor="let participant of challenge.participants || orderByChild">
      <ion-item *ngIf="!loading">
        <ion-icon item-left name="trophy"></ion-icon>
        <h2>{{participant.fitness_stats.name}} <i *ngIf="challenge.isComplete"><ion-icon color="primary" name="checkmark-circle"></ion-icon></i> </h2>
        <p style="white-space: normal"></p>
      </ion-item>
      <ion-item *ngIf="challenge.isComplete">
        <ion-icon item-left name="stopwatch"></ion-icon>
        <h2>5 Days</h2>
      </ion-item>
      <ion-item *ngIf="!loading">
        <ion-icon item-left name="flash"></ion-icon>
        <h2>{{participant.percentage}}%</h2>
        <progress value="{{participant.progress}}" max="{{challenge.completion}}"></progress>
      </ion-item>
    </ion-card>

  </ion-list>

</ion-content>